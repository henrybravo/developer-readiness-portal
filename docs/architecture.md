# Architecture

## Overview

Spec2Cloud uses a layered architecture with three main components:

```
┌─────────────────────────────────────────────────────────────┐
│                    GitHub Copilot Chat                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │   Agents    │  │   Prompts   │  │       Skills        │  │
│  │  @pm, @dev  │  │  /prd, /frd │  │  (auto-loaded)      │  │
│  │  @azure...  │  │  /plan...   │  │  13 task-focused    │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                     MCP Servers                             │
│  context7 • github • microsoft.docs • playwright • deepwiki │
├─────────────────────────────────────────────────────────────┤
│                   Dev Container                             │
│       Python 3.12 • Azure CLI • TypeScript • Docker         │
└─────────────────────────────────────────────────────────────┘
```

## Agents vs Prompts vs Skills

| Component | Location | Activation | Focus |
|-----------|----------|------------|-------|
| **Agents** | `.github/agents/` | Explicit `@mention` | Persona-focused (PM, Dev, Azure) |
| **Prompts** | `.github/prompts/` | Explicit `/command` | Workflow-focused (prd, frd, plan) |
| **Skills** | `.github/skills/` | Auto-loaded by context | Task-focused (with examples & templates) |

### Relationship

- **Agents** define *who* (persona, model, tools)
- **Prompts** define *what to do* (workflow commands)
- **Skills** provide *how to do it* (examples, templates, checklists)

Skills auto-load based on context matching from their SKILL.md description field. When you use a prompt like `/prd`, Copilot may automatically activate the related `prd-generation` skill based on the task context.

## Development Environment

The `.devcontainer/` folder provides a **ready-to-use development container** with:
- Python 3.12
- Azure CLI & Azure Developer CLI (azd)
- TypeScript
- Docker-in-Docker
- VS Code extensions: GitHub Copilot Chat, Azure Pack, AI Studio

## MCP Servers

The `.vscode/mcp.json` configures **Model Context Protocol servers** that give agents access to:
- **context7** - Up-to-date library documentation
- **github** - Repository management and operations
- **microsoft.docs.mcp** - Official Microsoft/Azure documentation
- **playwright** - Browser automation capabilities
- **deepwiki** - Repository context and understanding for external repos

## AI Agents (Chat Modes)

six specialized agents in `.github/chatmodes/`:

#### 1. **PM Agent** (`@pm`) - Product Manager
- **Model**: o3-mini
- **Tools**: Edit files, search, fetch web content
- **Purpose**: Translates ideas into structured PRDs and FRDs
- **Instructions**: Asks clarifying questions, identifies business goals, creates living documentation

#### 2. **Dev Lead Agent** (`@dev-lead`) - Technical Lead
- **Model**: Claude Sonnet 4
- **Tools**: Read files, search, semantic analysis  
- **Purpose**: Reviews architecture, provides technical guidance, ensures adherence to `AGENTS.md`
- **Instructions**: Analyzes engineering patterns, reviews technical decisions, validates against standards
- **Note**: AGENTS.md is auto-generated by `apm compile`

#### 3. **Dev Agent** (`@dev`) - Developer
- **Model**: Claude Sonnet 4
- **Tools**: Full development suite + Context7, GitHub, Microsoft Docs, Copilot Coding Agent, AI Toolkit
- **Purpose**: Breaks down features into tasks, implements code, or delegates to GitHub Copilot
- **Instructions**: Analyzes specs, writes modular code, follows architectural patterns, creates GitHub issues

#### 4. **Azure Agent** (`@azure`) - Cloud Architect
- **Model**: Claude Sonnet 4
- **Tools**: Azure resource management, Bicep, deployment tools, infrastructure best practices
- **Purpose**: Deploys applications to Azure with IaC and CI/CD pipelines
- **Instructions**: Analyzes codebase, generates Bicep templates, creates GitHub Actions, uses Azure Dev CLI


#### 5. **Reverse Engineering Tech Analyst Agent** (`@tech-analist`) - Technical Analyst
- **Model**: Claude Sonnet 4
- **Tools**: Code analysis, documentation generation, specification extraction
- **Purpose**: Reverse engineers existing codebases into specifications and documentation
- **Instructions**: Analyzes codebase, generates technical tasks, creates feature requirements, synthesizes product vision


#### 6. **Modernization Agent** (`@modernize`) - Modernization Specialist
- **Model**: Claude Sonnet 4
- **Tools**: Code analysis, modernization planning, risk assessment
- **Purpose**: Analyzes existing codebases for modernization opportunities and creates implementation plans
- **Instructions**: Assesses technical debt, crafts modernization strategies, develops risk management plans

## GitHub Copilot Skills

Skills are task-focused modules in `.github/skills/` that auto-load based on context:

| Category | Skills |
|----------|--------|
| **Specification** | prd-generation, frd-generation, adr-generation, spec-validation |
| **Planning** | implementation-planning, code-implementation, task-delegation |
| **Infrastructure** | azure-deployment, agents-generation |
| **Brownfield** | reverse-engineering, modernization-planning |
| **Utility** | shell-baseline-integration, documentation-synthesis |

Each skill contains:
- `SKILL.md` - Instructions with YAML frontmatter
- `examples/` - Sample outputs
- `templates/` - Reusable templates
- `checklists/` - Validation criteria (some skills)

See [skills.md](skills.md) for complete skill documentation.

## Directory Structure

```
.github/
├── agents/           # AI agent definitions (persona-focused)
│   ├── pm.agent.md
│   ├── dev.agent.md
│   └── ...
├── prompts/          # Workflow prompts (command-focused)
│   ├── prd.prompt.md
│   ├── frd.prompt.md
│   └── ...
└── skills/           # Task skills (auto-loaded)
    ├── prd-generation/
    │   ├── SKILL.md
    │   ├── examples/
    │   └── templates/
    ├── frd-generation/
    └── ...

specs/                # Generated specifications
├── prd.md
├── features/
├── tasks/
└── adr/
```

Back to [docs index](index.md).
